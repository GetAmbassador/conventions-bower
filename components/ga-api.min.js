angular.module("ngAmbassador.api",["restangular"]).factory("$api",["Restangular","$browserDetect",function(Restangular,$browserDetect){var instances=[],$api={create:function(config){var instance=Restangular.withConfig(function(RestangularConfigurer){RestangularConfigurer.setBaseUrl(config.url),RestangularConfigurer.setRequestSuffix("/"),RestangularConfigurer.setRestangularFields({id:"uid"}),"Explorer"===$browserDetect.name&&$browserDetect.version<=9&&(RestangularConfigurer.setJsonp(!0),RestangularConfigurer.setDefaultRequestParams("jsonp",{callback:"JSON_CALLBACK"})),RestangularConfigurer.setResponseExtractor(function(response,operation,what,url){var newResponse;return"getList"===operation?angular.isDefined(response.count)?((newResponse=response.results).count=response.count,newResponse.next=response.next,newResponse.previous=response.previous):(newResponse=response).count=_.size(response):newResponse=response,newResponse})});return instance.url=config.url,void 0!==config.default&&!0===config.default?(instance.default=!0,instances.default=instance):instance.default=!1,instances[config.identifier]=instance},use:function(identifier){var use=instances[identifier];return use.setToken=function(token){instances[identifier].token=token,use.setDefaultHeaders({Authorization:"Token "+token}),void 0!==instances[identifier]&&!0===instances[identifier]&&(instances.default.token=token,instances.default.setDefaultHeaders({Authorization:"Token "+token}))},use.getToken=function(){return instances[identifier].token},use.getUrl=function(){return instances[identifier].url},use}};return $api}]);